---
const services = [
  { name: "Corte de pelo", price: 10000 },
  { name: "Perfilado de barba", price: 8000 },
  { name: "Corte de pelo + barba", price: 14000 },
  { name: "Rizos permanentes", price: 50000 }
];

let selectedService = services[0];
let selectedPrice = selectedService.price;
let selectedTime = "";
let abonoprice = selectedPrice / 2;
---

<div class="p-6 bg-white">
  <h1 class="text-xl mb-4">Reserva tu hora aquí!</h1>
  
  <label class="block mb-2">Selecciona tu servicio:</label>
  <select class="border p-2 w-full" id="serviceSelect">
    {services.map(service => (
      <option value={service.name}>{service.name} - ${service.price}</option>
    ))}
  </select>
  <label class="block mb-2">Selecciona una fecha:</label>
  <input type="datetime-local" class="border p-2 w-full" id="timeSelect" />
  <p class="mt-4 text-lg font-semibold">
    Abono: <span id="abono">${abonoprice}</span>
    <br>
    Día: <span id="selectedTime"></span>
  </p>


  <button class="mt-4 bg-black text-white rounded hover:bg-[#9b9e7d] p-2 w-full" onclick="handlePayment()">
    Pagar abono
  </button>
</div>

<script>
        document.addEventListener("DOMContentLoaded", () => {
    const selectElement = document.getElementById("serviceSelect");
    if (selectElement) {
        selectElement.addEventListener("change", updateService);
        console.log("Evento change vinculado correctamente al select.");
    } else {
        console.error("Error: No se encontró el elemento select.");
    }
        const timeElement = document.getElementById("timeSelect");
    if (timeElement) {
        timeElement.addEventListener("change", updateTime);
        console.log("Evento change vinculado correctamente al input de fecha/hora.");
    } else {
        console.error("Error: No se encontró el elemento datetime-local.");
    }
});


  let services = [
    { name: "Corte de pelo", price: 10000 },
    { name: "Perfilado de barba", price: 8000 },
    { name: "Corte de pelo + barba", price: 14000 },
    { name: "Rizos permanentes", price: 50000 }
  ];

  let selectedService = services[0]; 
  let selectedPrice = selectedService.price;
  let selectedTime = "";

  function updateService(event: Event) {
  const serviceName = (event.target as HTMLSelectElement).value;
  const newService = services.find(s => s.name === serviceName);

  if (!newService) {
    console.error("Error: Servicio no encontrado.");
    return;
  }

  selectedService = newService;
  selectedPrice = selectedService.price;


  const abonoElement = document.getElementById("abono");
  if (abonoElement) {
    abonoElement.innerText = (selectedPrice / 2).toString();
  }
}

function updateTime(event: Event) {
    console.log("Ejecutando updateTime()");

    selectedTime = (event.target as HTMLInputElement).value;
    console.log("Fecha/hora seleccionada:", selectedTime);

    // Asegurar que `selectedTime` se refleje en el HTML
    const displayTimeElement = document.getElementById("selectedTime");
    if (displayTimeElement) {
        displayTimeElement.innerText = selectedTime;
    } else {
        console.error("Error: No se encontró el elemento selectedTime.");
    }
}

</script>